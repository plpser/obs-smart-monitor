# 📊 智能文件监控程序 - 优化版

## 🎯 功能特点
- 🔄 实时监控指定文件的变化
- 📝 当文件内容发生变化时，自动获取并显示最后一行内容  
- 🆕 支持文件创建和修改事件
- 🗑️ 智能处理文件删除并自动切换到最新文件
- ⚡ 防止重复触发机制
- 🎨 优化的输出界面，信息一目了然
- ⏱️ 可配置的监控频率

## ⚙️ 监控参数配置

### 📈 监控频率设置
- **内容变化检测**: 0.5秒间隔（实时响应）
- **新文件检查**: 每10分钟自动检查
- **自动文件切换**: 发现更新文件时立即切换

### 🎨 输出优化
- **图标标识**: 使用emoji图标区分不同类型的消息
- **时间戳**: 精确到秒的时间显示
- **分层信息**: 清晰的信息层级结构
- **颜色区分**: 不同类型事件使用不同的视觉标识

## 🚀 使用方法

### 1. 📦 安装依赖
```bash
pip install watchdog
```

### 2. ▶️ 运行程序
```bash
python fileMonitor.py
```

### 3. 🔧 选择监控模式
程序启动后会提供两种模式选择：
- **模式1**: 监控实际的 FlyAiLive1 日志目录
- **模式2**: 使用测试模式（自动创建测试文件）

### 4. 🧪 测试功能
- 📝 修改监控文件内容并保存
- 🗑️ 删除监控文件测试自动切换
- 📁 创建新的用户发言记录文件测试自动检测

## 📊 输出界面说明

### 🎯 事件类型标识
- 📅 `[时间]` - 普通信息
- ✅ `[时间]` - 成功操作
- ⚠️ `[时间]` - 警告信息
- ❌ `[时间]` - 错误信息
- 📄 `[时间]` - 文件内容变化
- 🔄 `[时间]` - 文件切换

### 📋 信息层级
```
📄 [14:30:15] 文件内容变化
   📁 文件: 用户发言记录_2025_01_03.txt
   📝 最后一行: 用户刚刚发送的消息内容
   --------------------------------------------------
```

## ⚡ 性能优化

### 📈 监控效率
- **快速响应**: 0.5秒内容检测间隔确保实时性
- **智能检查**: 10分钟新文件检查间隔平衡性能和及时性
- **事件防抖**: 避免重复触发机制

### 💾 资源消耗
- **低CPU占用**: 高效的文件监控算法
- **最小内存**: 仅加载必要的文件内容
- **自动清理**: 智能的资源管理

## 🛠️ 高级功能

### 🔄 自动文件切换
- 监控文件被删除时自动切换到最新文件
- 发现更新的用户发言记录文件时主动切换
- 保持监控的连续性

### 📊 实时状态显示
- 当前监控文件信息
- 监控参数配置
- 功能状态说明

## 📝 注意事项
- ✅ 程序支持 UTF-8 编码的文本文件
- ⌨️ 按 Ctrl+C 可以停止监控
- 🔐 确保有文件的读取权限
- 📁 确保目标目录存在且可访问

## 🎮 快速开始示例

1. **启动程序**
   ```bash
   python fileMonitor.py
   ```

2. **选择测试模式** (输入 `2`)
   ```
   请选择监控模式:
      1️⃣  实际模式 - 监控 FlyAiLive1 日志目录
      2️⃣  测试模式 - 监控本地 test_logs 文件夹
   
   ➡️  请输入选择 (1/2): 2
   ```

3. **程序会自动**：
   - 🔍 查找最新的用户发言记录文件
   - 📊 显示文件信息和当前最后一行
   - 🚀 启动监控服务

4. **测试功能**：
   - ✏️ 用记事本打开测试文件并添加新内容
   - 👀 观察程序实时显示最后一行变化
   - 🗑️ 删除文件测试自动切换功能